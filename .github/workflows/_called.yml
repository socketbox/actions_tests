name: Called Workflow
on:
  workflow_call:
    inputs:
      environment:
        description: 'the environment to deploy to'
        required: true
        type: string

jobs:
  environment-test:
    runs-on: ubuntu-latest
    steps:
      - name: Map option to environment
        run: |
          if [[ ${{inputs.aws_profile}} == 'dev' ]]
          then
            echo secret_prefix=EDCAR >> $GITHUB_ENV
          else
            secret_prefix=${ ${{inputs.aws_profile}}^^}
            echo secret_prefix=$secret_prefix >> $GITHUB_ENV
            echo ${{env.secret_prefix}}
          fi
      - name: Secret test
        run: |
          echo "Secret FOO_SECRET: $FOO_SECRET"
          echo "Secret PREPROD_REGION: $PREPROD_SECRET"
          echo "Env BUGGER: $BUGGER"
        env:
          FOO_SECRET: format('chocolate_{0}', bar)
          #PREPROD_SECRET: format('${{ secrets.{0}_REGION }}', 'PREPROD')
          PREPROD_SECRET: format('secrets.{0}_REGION', 'PREPROD')
          BUGGER: all
